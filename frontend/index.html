<!DOCTYPE html>  
<html lang="en">  
<head>  
  <meta charset="UTF-8" />  
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />  
  <title>Pantheon • XP Silver</title>  
  <meta name="color-scheme" content="light">  
  <style>  
    :root{  
      --silver1:#f2f3f7;  
      --silver2:#e0e3ee;  
      --silver3:#cfd5e3;  
      --silver4:#bcc6d6;  
      --ink:#2a3550;  
      --muted:#63739a;  
      --accent:#3b79f7;  
      --accent2:#78a8ff;  
      --pane: #ffffffcc;  
      --border:#aeb8c9;  
      --shadow: rgba(28,40,70,.15);  
    }  
    html,body{height:100%;margin:0;background:  
      radial-gradient(1200px 600px at 50% -10%, #ffffff, #e8ecf7 45%, #dfe5f4 70%, #d7dfef 85%, #d2daec 100%),  
      linear-gradient(180deg,#f6f8fc,#e7ecf8);  
      color:var(--ink);  
      font-family: Tahoma, Verdana, Segoe UI, sans-serif;  
      letter-spacing:.1px;  
    }  
    /* Subtle grid for early-2000s feel */  
    body::before{  
      content:"";position:fixed;inset:0;pointer-events:none;  
      background:  
        linear-gradient(to right, rgba(70,90,130,.05) 1px, transparent 1px) 0 0/40px 40px,  
        linear-gradient(to bottom, rgba(70,90,130,.05) 1px, transparent 1px) 0 0/40px 40px;  
    }  
  
    .shell{  
      max-width: 980px; margin: 36px auto; border-radius: 12px; overflow:hidden;  
      background: linear-gradient(180deg, var(--silver1), var(--silver2));  
      border: 1px solid var(--border);  
      box-shadow: 0 18px 60px var(--shadow), inset 0 1px 0 #fff;  
    }  
    .titlebar{  
      background: linear-gradient(180deg, #ffffff, #e9edf7);  
      border-bottom:1px solid var(--border);  
      display:flex;align-items:center;justify-content:space-between;gap:12px;  
      padding:10px 14px;  
    }  
    .left{display:flex;align-items:center;gap:10px;}  
    .orb{  
      width:16px;height:16px;border-radius:50%;  
      background: radial-gradient(circle at 35% 35%, #fff, #9cc3ff 45%, #5e8fff 70%, #2e5eea 100%);  
      box-shadow: inset 0 1px 2px #fff, 0 0 6px #9cc3ff;  
      border:1px solid #6a92ea;  
    }  
    .app{font-weight:700; letter-spacing:.6px; color:#1f2c4f;}  
  
    .toolbar{display:flex;align-items:center;gap:8px;}  
    .btn{  
      padding:6px 12px; font-weight:700; color:#1f2c4f; cursor:pointer;  
      background: linear-gradient(180deg,#ffffff,#dfe6f7 55%,#c9d4ee);  
      border:1px solid #9fb0c9; border-radius:8px;  
      box-shadow: inset 0 1px 0 #fff, 0 2px 0 rgba(0,0,0,.08);  
      transition: transform .06s ease;  
    }  
    .btn:active{transform: translateY(1px);}  
  
    .marquee{  
      padding:6px 10px; font-size:12px; color:#2a3550;  
      background: linear-gradient(180deg,#f7f9fe,#edf1fa);  
      border-bottom:1px solid #cbd3e2;  
    }  
    .main{display:grid; grid-template-columns: 240px 1fr; min-height:520px;}  
    .side{  
      background: linear-gradient(180deg,#f9fbff,#eff3fb);  
      border-right:1px solid var(--border);  
    }  
    .panel{padding:14px 14px 18px; border-bottom:1px solid #d9e1f0;}  
    .panel h4{margin:0 0 10px; font-size:12px; color:#55658b; text-transform:uppercase; letter-spacing:1px;}  
  
    .nav a{  
      display:block; padding:8px 10px; margin-bottom:8px; text-decoration:none; color:#203055; font-weight:700;  
      border:1px solid #b9c5d8; border-radius:8px;  
      background: linear-gradient(180deg,#ffffff,#e8eef9);  
    }  
    .nav a:hover{background:#f5f8fe;}  
  
    .badge{  
      display:inline-block; padding:2px 6px; font-size:10px; letter-spacing:1px; border-radius:6px;  
      border:1px solid #a8b7d2; color:#2a3550; background: linear-gradient(180deg,#ffffff,#ebf1fb);  
      float:right;  
    }  
  
    .content{  
      padding:18px 20px 28px;  
      background: linear-gradient(180deg, #ffffff, #f2f5fc);  
    }  
    .card{  
      background: linear-gradient(180deg,#ffffff,#eff3fb);  
      border:1px solid #b9c5d8; border-radius:12px;  
      box-shadow: inset 0 1px 0 #fff, 0 10px 30px var(--shadow);  
      padding:16px; margin-bottom:18px;  
    }  
    .card h3{margin:0 0 8px;}  
    .meta{color:var(--muted); font-size:12px;}  
  
    table{width:100%; border-collapse:collapse; font-size:14px; background:#fff; border:1px solid #c6d0e2;}  
    th, td{padding:10px 12px; border-bottom:1px solid #e4e9f4;}  
    th{text-align:left; background: linear-gradient(180deg,#f3f6fd,#e6ecfa); color:#41527b;}  
    tr:hover td{background:#f6f9ff;}  
  
    .footer{  
      display:flex; align-items:center; justify-content:space-between;  
      padding:10px 14px; font-size:12px; color:#41527b; background: linear-gradient(180deg,#f5f8fe,#e9eef8);  
      border-top:1px solid #c6d0e2;  
    }  
    .counter{  
      display:inline-block; font-family:"Courier New", monospace; letter-spacing:2px;  
      padding:4px 8px; background:#eaf1ff; color:#235df6; border:1px solid #9bb8ff; border-radius:4px;  
      box-shadow: inset 0 0 6px #dfe9ff;  
    }  
  
    .section{display:none;}  
    .section.active{display:block;}  
  
    /* Login mini form */  
    .login{  
      display:flex; gap:6px; align-items:center; flex-wrap:wrap;  
    }  
    .input{  
      padding:6px 8px; border:1px solid #aeb8c9; border-radius:6px; background:#fff; color:#2a3550;  
    }  
  
    @media (max-width:860px){  
      .main{grid-template-columns:1fr;}  
      .side{order:2;}  
      .content{order:1;}  
    }  
  </style>  
</head>  
<body>  
  <div class="shell">  
    <div class="titlebar">  
      <div class="left">  
        <span class="orb" aria-hidden="true"></span>  
        <span class="app">Pantheon • XP Silver</span>  
      </div>  
      <div class="toolbar">  
        <!-- Login controls for auth-required resources (games) -->  
        <div class="login">  
          <input class="input" id="email" type="email" placeholder="email" />  
          <input class="input" id="password" type="password" placeholder="password" />  
          <button class="btn" id="loginBtn">Sign in</button>  
          <button class="btn" id="logoutBtn" style="display:none">Sign out</button>  
        </div>  
      </div>  
    </div>  
  
    <div class="marquee">  
      <marquee behavior="scroll" direction="left" scrollamount="4">Pantheon — clean early-2000s silver UI. Reviews are public; Games require sign-in.</marquee>  
    </div>  
  
    <div class="main">  
      <aside class="side">  
        <div class="panel">  
          <h4>Navigation</h4>  
          <nav class="nav" id="nav">  
            <a href="#games" data-section="games">Games Directory <span class="badge">auth</span></a>  
            <a href="#reviews" data-section="reviews">Latest Reviews <span class="badge">public</span></a>  
            <a href="#about" data-section="about">About</a>  
            <a href="#links" data-section="links">Links</a>  
          </nav>  
        </div>  
        <div class="panel">  
          <h4>Status</h4>  
          <div class="meta">Backend: proxied via /api</div>  
          <div class="meta">Auth: <span id="authStatus">Logged out</span></div>  
        </div>  
      </aside>  
  
      <section class="content">  
        <!-- Games (requires auth) -->  
        <div class="section active" id="section-games">  
          <div class="card">  
            <h3>Games Directory</h3>  
            <div class="meta">Sign in to list games (PocketBase requires auth for this collection).</div>  
          </div>  
          <div class="card">  
            <table aria-label="Games table">  
              <thead>  
                <tr>  
                  <th>Name</th>  
                  <th>External ID</th>  
                  <th>Created</th>  
                </tr>  
              </thead>  
              <tbody id="gamesTable">  
                <tr><td colspan="3" class="meta">Sign in to load games…</td></tr>  
              </tbody>  
            </table>  
          </div>  
        </div>  
  
        <!-- Reviews (public when visibility is Public) -->  
        <div class="section" id="section-reviews">  
          <div class="card">  
            <h3>Latest Reviews</h3>  
            <div class="meta">Public reviews are visible without signing in.</div>  
          </div>  
          <div class="card" id="reviewsList">  
            <div class="meta">Loading…</div>  
          </div>  
        </div>  
  
        <!-- About -->  
        <div class="section" id="section-about">  
          <div class="card">  
            <h3>About Pantheon</h3>  
            <p>  
              Minimal early-2000s “Silver” interface—soft gradients, beveled panels, and a neat directory layout.  
              Frontend served by Nginx; PocketBase proxied under /api.  
            </p>  
          </div>  
        </div>  
  
        <!-- Links -->  
        <div class="section" id="section-links">  
          <div class="card">  
            <h3>Useful</h3>  
            <ul>  
              <li>PocketBase Admin via http://localhost:8080/_/</li>  
              <li>API base: /api</li>  
            </ul>  
          </div>  
        </div>  
      </section>  
    </div>  
  
    <div class="footer">  
      <div>© 2004–2025 Pantheon</div>  
      <div>Visits <span class="counter" id="counter">000001</span></div>  
    </div>  
  </div>  
  
  <!-- PocketBase SDK via CDN -->  
  <script src="https://unpkg.com/pocketbase/dist/pocketbase.umd.js"></script>  
  <script>  
    // Basic router  
    const sections = {  
      games: document.getElementById('section-games'),  
      reviews: document.getElementById('section-reviews'),  
      about: document.getElementById('section-about'),  
      links: document.getElementById('section-links'),  
    };  
    function show(section){  
      Object.values(sections).forEach(s=>s.classList.remove('active'));  
      (sections[section] || sections.games).classList.add('active');  
      history.replaceState({}, '', '#' + section);  
      if(section==='reviews') loadReviews();  
      if(section==='games') loadGames();  
    }  
    document.getElementById('nav').addEventListener('click', (e)=>{  
      const a = e.target.closest('a[data-section]');  
      if(!a) return;  
      e.preventDefault();  
      show(a.dataset.section);  
    });  
    show((location.hash||'#games').slice(1));  
  
    // Hit counter  
    const counterEl = document.getElementById('counter');  
    const key = 'pantheon_hits';  
    const n = (parseInt(localStorage.getItem(key) || '0', 10) + 1);  
    localStorage.setItem(key, String(n));  
    counterEl.textContent = String(n).padStart(6,'0');  
  
    // PocketBase client (proxied through Nginx to pocketbase service)  
    const pb = new PocketBase('/api');  
    const authStatus = document.getElementById('authStatus');  
    function updateAuthUI(){  
      const logged = pb.authStore.isValid;  
      authStatus.textContent = logged ? 'Logged in' : 'Logged out';  
      document.getElementById('loginBtn').style.display = logged ? 'none' : 'inline-block';  
      document.getElementById('logoutBtn').style.display = logged ? 'inline-block' : 'none';  
    }  
    updateAuthUI();  
  
    // Auth handlers  
    document.getElementById('loginBtn').addEventListener('click', async ()=>{  
      const email = document.getElementById('email').value.trim();  
      const password = document.getElementById('password').value;  
      if(!email || !password){ alert('Enter email and password'); return; }  
      try {  
        // Assuming you have a regular auth collection (_pb_users_auth_) with email/password users  
        await pb.collection('users').authWithPassword(email, password);  
        updateAuthUI();  
        if (location.hash.slice(1) === 'games') loadGames();  
      } catch (e){  
        console.error(e);  
        alert('Login failed');  
      }  
    });  
    document.getElementById('logoutBtn').addEventListener('click', ()=>{  
      pb.authStore.clear();  
      updateAuthUI();  
      document.getElementById('gamesTable').innerHTML = '<tr><td colspan="3" class="meta">Sign in to load games…</td></tr>';  
    });  
  
    // Load Reviews (public ones)  
    async function loadReviews(){  
      const container = document.getElementById('reviewsList');  
      container.innerHTML = '<div class="meta">Loading…</div>';  
      try {  
        // Expand related fields to show names; adjust per your schema  
        const res = await pb.collection('reviews').getList(1, 10, {  
          expand: 'game,platform,visibility_status,accuracy_status,completion_status,tier'  
        });  
        const items = res.items || [];  
        if(!items.length){  
          container.innerHTML = '<div class="meta">No public reviews yet.</div>';  
          return;  
        }  
        container.innerHTML = items.map(r => {  
          const game = r.expand?.game?.name || '(unknown)';  
          const platform = r.expand?.platform?.name || '';  
          const vis = r.expand?.visibility_status?.name || '';  
          const tier = r.expand?.tier?.name || '';  
          const date = new Date(r.created).toLocaleDateString();  
          return `  
            <div class="card" style="margin-bottom:12px">  
              <h3>${game}</h3>  
              <div class="meta">${platform} • ${date} • ${vis}${tier ? ' • Tier '+tier : ''}</div>  
              ${r.contents ? `<div>${r.contents}</div>` : ''}  
            </div>  
          `;  
        }).join('');  
      } catch (e){  
        console.error(e);  
        container.innerHTML = '<div class="meta">Failed to load reviews.</div>';  
      }  
    }  
  
    // Load Games (requires auth per your rules)  
    async function loadGames(){  
      const tbody = document.getElementById('gamesTable');  
      if(!pb.authStore.isValid){  
        tbody.innerHTML = '<tr><td colspan="3" class="meta">Sign in to load games…</td></tr>';  
        return;  
      }  
      tbody.innerHTML = '<tr><td colspan="3" class="meta">Loading…</td></tr>';  
      try {  
        const res = await pb.collection('games').getList(1, 50, { sort: 'name' });  
        const rows = (res.items || []).map(g => `  
          <tr>
            <td>${g.name || '—'}</td>
            <td>${g.external_id || ''}</td>
            <td>${new Date(g.created).toLocaleDateString()}</td>
          </tr>
        `).join('');
        tbody.innerHTML = rows || '<tr><td colspan="3" class="meta">No games yet.</td></tr>';
      } catch (e){
        console.error(e);
        tbody.innerHTML = '<tr><td colspan="3" class="meta">Failed to load games.</td></tr>';
      }
    }

    // Auto-load public reviews initially for a nice first impression  
    if ((location.hash||'#reviews').slice(1) === 'reviews') loadReviews();  
  </script>
</body>
</html>
